@using DataModels.VM.LogBook;
@using DataModels.Enums;

<TelerikForm Model="@logBookVM" OnValidSubmit="@Submit">

    <FormValidation>
        <CustomValidationSummary> </CustomValidationSummary>
    </FormValidation>
    <FormItems>
        <div class="row mx-0 my-1" style="margin-top:9px !important">

            <div class="col-md-12 d-flex justify-content-end">
                <TelerikButton Class="btn k-btn-primary" ButtonType="@ButtonType.Button" ThemeColor="primary" OnClick="(() => AddEntry())">
                    <CustomIcons IconName="add" PrimaryColor="White"></CustomIcons> Add
                </TelerikButton>
                <FormFooterComponent id="@logBookVM.Id" IsSubmitButtonLoading="@isBusySubmitButton" IsHideCancelButton="true">
                </FormFooterComponent>
            </div>
        </div>
        <div class="row m-0">
            <div class="logbook-header d-flex justify-content-between align-items-center my-1" @onclick=@(() => ToggleVisibility_LogBookEntry())>
                <span><FontLabel fontColor="#0D89DD">LogBook Entry</FontLabel></span>
                <span>
                    @*<FontLabel fontColor="#042455">Configure</FontLabel>*@
                    @if (isLogBookEntryVisible)
                    {
                        <CustomIcons IconName="minus" />
                    }
                    else
                    {
                        <CustomIcons IconName="plus" />
                    }
                </span>
            </div>
            <input type="hidden" value="@logBookVM.Id" name="Id" />
            <div class="col-12 py-1 @(!isLogBookEntryVisible ? "d-none":"")">
                <div class="row my-0" style="margin-bottom: 10px !important;margin-top: 8px !important;">
                    <div class="col-2" />
                    <div class="col-2">
                        <div><label>Date</label></div>
                        <TelerikDatePicker Class="logbook-control-max-width" @bind-Value="@logBookVM.Date" Id="date"></TelerikDatePicker>
                    </div>

                    <div class="col-2">
                        <label>Departure</label>
                        <TelerikTextBox Class="logbook-control-max-width" Id="departureAirport" @bind-Value="@logBookVM.Departure" Placeholder="Departure"></TelerikTextBox>
                    </div>

                    <div class="col-2">
                        <label>Arrival</label>
                        <TelerikTextBox Class="logbook-control-max-width" Id="arrivalAirport" @bind-Value="@logBookVM.Arrival" Placeholder="Arrival"></TelerikTextBox>
                    </div>

                    <div class="col-2">
                        <label>Aircrafts</label>
                        <TelerikComboBox Id=aircraft Data="@AircraftsList" TextField="Name" Class="logbook-control-max-width"
                                         Filterable="true" FilterOperator="@StringFilterOperator.Contains"
                                         Placeholder="Select Aircraft" ValueField="Id" @bind-Value="@(logBookVM.AircraftId)">
                        </TelerikComboBox>
                        <TelerikValidationMessage For="@(() => logBookVM.AircraftId)"></TelerikValidationMessage>
                    </div>
                </div>

                <div class="row my-0" style="margin-bottom:8px !important;">
                    <div class="col-2" />
                    <div class="col-2">
                        <label>Total Time</label>
                        <TelerikNumericTextBox Class="logbook-control-max-width" Id="totalTime" @bind-Value=@logBookVM.TotalTime Placeholder="Hours" />
                    </div>

                    <div class="col-2">
                        <label>PIC</label>
                        <TelerikNumericTextBox Class="logbook-control-max-width" Id="totalTime" @bind-Value=@logBookVM.PIC Placeholder="Hours" />
                    </div>

                    <div class="col-2">
                        <label>SIC</label>
                        <TelerikNumericTextBox Class="logbook-control-max-width" Id="totalTime" @bind-Value=@logBookVM.SIC Placeholder="Hours" />
                    </div>

                    <div class="col-2">
                        <label>Night</label>
                        <TelerikNumericTextBox Class="logbook-control-max-width" Id="totalTime" @bind-Value=@logBookVM.Night Placeholder="Hours" />
                    </div>
                </div>
                <div class="row my-0" style="margin-bottom:8px !important;">
                    <div class="col-2" />
                    <div class="col-2">
                        <label>Solo</label>
                        <TelerikNumericTextBox Class="logbook-control-max-width" Id="totalTime" @bind-Value=@logBookVM.Solo Placeholder="Hours" />
                    </div>

                    <div class="col-2">
                        <label>Cross Country</label>
                        <TelerikNumericTextBox Class="logbook-control-max-width" Id="totalTime" @bind-Value=@logBookVM.CrossCountry Placeholder="Hours" />
                    </div>
                </div>
            </div>
        </div>

        <div class="row m-0">
            <div class="logbook-header d-flex justify-content-between align-items-center my-1" @onclick=@(() => ToggleVisibility_TakeoffsLandings())>
                <span><FontLabel fontColor="#0D89DD">Takeoffs & Landings</FontLabel></span>
                <span>
                    @*<FontLabel fontColor="#042455">Configure</FontLabel>*@
                    @if (isTakeoffsLandingsVisible)
                    {
                        <CustomIcons IconName="minus" />
                    }
                    else
                    {
                        <CustomIcons IconName="plus" />
                    }
                </span>
            </div>
            <div class="col-12 py-1 @(!isTakeoffsLandingsVisible ? "d-none":"")">
                <div class="row my-0" style="margin-bottom: 8px !important;margin-top: 8px !important;">
                    <div class="col-2" />
                    <div class="col-2">
                        <label>Day Takeoffs</label>
                        <TelerikNumericTextBox Class="logbook-control-max-width" Id="dayTakeoffs" @bind-Value=@logBookVM.DayTakeoffs Placeholder="Hours" />
                    </div>
                    <div class="col-2">
                        <label>Day Landings Full Stop</label>
                        <TelerikNumericTextBox Class="logbook-control-max-width" Id="nightTakeoffs" @bind-Value=@logBookVM.DayLandingsFullStop Placeholder="Hours" />
                    </div>
                    <div class="col-2">
                        <label>Night Takeoffs</label>
                        <TelerikNumericTextBox Class="logbook-control-max-width" Id="nightTakeoffs" @bind-Value=@logBookVM.NightTakeoffs Placeholder="Hours" />
                    </div>
                    <div class="col-2">
                        <label>Night Landings Full Stop</label>
                        <TelerikNumericTextBox Class="logbook-control-max-width" Id="nightLandingsFullStop" @bind-Value=@logBookVM.NightLandingsFullStop Placeholder="Hours" />
                    </div>

                </div>
                <div class="row my-0" style="margin-bottom: 8px !important;margin-top: 8px !important;">
                    <div class="col-2" />
                    <div class="col-2">
                        <label>All Landings</label>
                        <TelerikNumericTextBox Class="logbook-control-max-width" Id="totalTime" @bind-Value=@logBookVM.AllLandings Placeholder="Hours" />
                    </div>
                </div>
            </div>
        </div>

        <div class="row m-0">
            <Instrument logBookVM="@logBookVM"
                        ShowBodyPart="isInstrumentVisible"
                        OnToggle="@(() => ToggleVisibility_Instrument())" />
        </div>

        <div class="row m-0">
            <div class="logbook-header d-flex justify-content-between align-items-center my-1" @onclick=@(() => ToggleVisibility_RouteDistance())>
                <span><FontLabel fontColor="#0D89DD">Route & Distance</FontLabel></span>
                <span>
                    @*<FontLabel fontColor="#042455">Configure</FontLabel>*@
                    @if (isRouteDistanceVisible)
                    {
                        <CustomIcons IconName="minus" />
                    }
                    else
                    {
                        <CustomIcons IconName="plus" />
                    }
                </span>
            </div>
            <div class="row py-1 my-0 @(!isRouteDistanceVisible ? "d-none":"")" style="display:flex;margin-bottom:12px !important;">
                <div class="col-2" />
                <div class="col-2">
                    <label>Distance</label>
                    <TelerikNumericTextBox Class="logbook-control-max-width" Id="distance" @bind-Value="@logBookVM.Distance" Placeholder="Distance"></TelerikNumericTextBox>
                </div>

                <div class="col-2">
                    <label>Route</label>
                    <TelerikTextBox Id="route" Class="logbook-control-max-width" @bind-Value="@logBookVM.Route" PlaceHolder="Route"></TelerikTextBox>
                </div>
            </div>
        </div>

        <div class="row m-0">
            <TimeDetails LogBookTimeDetails="@logBookVM.LogBookFlightTimeDetailVM"
                         ShowBodyPart="isStartEndVisible"
                         OnToggle="@(() => ToggleVisibility_StartEnd())" />
        </div>

        <div class="row m-0">
            <div class="logbook-header d-flex justify-content-between align-items-center my-1" @onclick=@(() => ToggleVisibility_NightVisionGoggles())>
                <span><FontLabel fontColor="#0D89DD">Night Vision Goggles</FontLabel></span>
                <span>
                    @*<FontLabel fontColor="#042455">Configure</FontLabel>*@
                    @if (isNightVisionGogglesVisible)
                    {
                        <CustomIcons IconName="minus" />
                    }
                    else
                    {
                        <CustomIcons IconName="plus" />
                    }
                </span>
            </div>
            <div class="row py-1 my-0 @(!isNightVisionGogglesVisible ? "d-none":"")" style="display:flex;margin-bottom:16px !important">
                <div class="col-2" />
                <div class="col-2">
                    <label>NVG</label>
                    <TelerikNumericTextBox Class="logbook-control-max-width" Id="nvg" @bind-Value="@logBookVM.NVG" Placeholder="NVG"></TelerikNumericTextBox>
                </div>

                <div class="col-2">
                    <label>NVG Operations</label>
                    <TelerikNumericTextBox Class="logbook-control-max-width" Id="nvgOperations" @bind-Value="@logBookVM.NVGOperations" Placeholder="NVG Operations"></TelerikNumericTextBox>
                </div>
            </div>
        </div>

        <div>

            <Web.UI.Pages.LogBook.CrewPassenger.CrewPassenger LogBookCrewPassengersList="@logBookVM.LogBookCrewPassengersList" RolesList="@RolesList"
                                                              PassengersList="@PassengersList" UsersList=@UsersList
                                                              CrewPassengersList="@logBookVM.CrewPassengersList">
            </Web.UI.Pages.LogBook.CrewPassenger.CrewPassenger>

        </div>

        <div class="row m-0">
            <TrainingDetails LogBookTrainingDetailVM="@logBookVM.LogBookTrainingDetailVM" ShowBodyPart="isTrainingVisible" OnToggle="@(() => ToggleVisibility_Training())"></TrainingDetails>
        </div>

        <div class="row m-0">
            <Photos ShowBodyPart="isFlightPhotosVisible" PhotosList="@logBookVM.LogBookFlightPhotosList" OnToggle="@(() => ToggleVisibility_FlightPhotos())"></Photos>
        </div>

        <div class="row m-0">
            <div class="logbook-header d-flex justify-content-between align-items-center my-1" @onclick=@(() => ToggleVisibility_Comments())>
                <span><FontLabel fontColor="#0D89DD">Comments</FontLabel></span>
                <span>
                    @*<FontLabel fontColor="#042455">Configure</FontLabel>*@
                    @if (isCommentsVisible)
                    {
                        <CustomIcons IconName="minus" />
                    }
                    else
                    {
                        <CustomIcons IconName="plus" />
                    }
                </span>
            </div>
            <div class="col-2" />
            <div class="col-8 py-1 @(!isCommentsVisible ? "d-none":"")" style="margin-top:8px !important;">
                <TelerikTextBox Id="comments" @bind-Value="@logBookVM.Comments" Placeholder="Comments" Class="textarea-height"></TelerikTextBox>
            </div>
        </div>
    </FormItems>

    <FormButtons>
        <div class="row mx-0 my-1">
            <div class="col-md-12 text-right">
                <FormFooterComponent id="@logBookVM.Id" IsSubmitButtonLoading="@isBusySubmitButton">
                </FormFooterComponent>
            </div>
        </div>
    </FormButtons>
</TelerikForm>

@if (isDisplayPopup)
{
    <CustomPopupComponent Title="@popupTitle"
                      HeaderCssClass=@CustomPopupComponent.GetHeaderCssClass(operationType)
                      CloseOnOutsideClick="false"
                      OnClose="@(()=> {isDisplayPopup = false;})">
        <Body>

            @if (operationType == OperationType.Create || operationType == OperationType.Edit)
            {
                <Web.UI.Pages.LogBook.CrewPassenger.Create crewPassengerVM=@(new CrewPassengerVM())
                                                   CloseDialogCallBack="@CloseCrewPassengerDialog">
                </Web.UI.Pages.LogBook.CrewPassenger.Create>
            }

        </Body>
    </CustomPopupComponent>
}
